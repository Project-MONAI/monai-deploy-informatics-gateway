<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Setup | MONAI Deploy Informatics Gateway v0.3.15 </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Setup | MONAI Deploy Informatics Gateway v0.3.15 ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../images/favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/MONAI-logo-color.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="setup">Setup</h1>
<!--
  ~ Copyright 2021-2022 MONAI Consortium
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
-->

<p>This section outlines the steps to download and install the Informatics Gateway using the CLI and Docker image.</p>
<h2 id="runtime-requirements">Runtime Requirements</h2>
<ul>
<li>Docker 20.10.12 or higher</li>
</ul>
<p>For development requirements, refer to the <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway">Informatics Gateway README.md</a>.</p>
<h2 id="installation">Installation</h2>
<h3 id="informatics-gateway-cli">Informatics Gateway CLI</h3>
<p>Download and install the Informatics Gateway CLI from the <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway/releases">Releases</a> section of
the repository and install it.</p>
<h4 id="on-linux">On Linux</h4>
<pre><code class="lang-bash"># Download the CLI
curl -LO https://github.com/Project-MONAI/monai-deploy-informatics-gateway/releases/download/0.2.0/mig-cli-0.2.0-linux-x64.zip
# Calculate the SHA256 checksum and verify the output with the checksum on the Releases page.
sha256sum mig-cli-0.2.0-linux-x64.zip
# Unzip the CLI
unzip mig-cli-0.2.0-linux-x64.zip
# Install it in bin
sudo mv mig-cli /usr/local/bin
</code></pre>
<h4 id="on-windows">On Windows</h4>
<pre><code class="lang-powershell"># Download the CLI
curl -LO https://github.com/Project-MONAI/monai-deploy-informatics-gateway/releases/download/0.2.0/mig-cli-0.2.0-win-x64.zip
# Calculate the SHA256 checksum and verify the output with the checksum on the Releases page.
Get-FileHash mig-cli-0.2.0-win-x64.zip
# Unzip the CLI
Expand-Archive -Path mig-cli-0.2.0-win-x64.zip
</code></pre>
<h3 id="informatics-gateway-docker-image">Informatics Gateway Docker Image</h3>
<p>Navigate to the <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway/pkgs/container/monai-deploy-informatics-gateway">monai-deploy-informatics-gateway package</a>
page and locate the version to download.</p>
<pre><code class="lang-bash"># for the latest build
docker pull ghcr.io/project-monai/monai-deploy-informatics-gateway:latest
# or for a versioned build
docker pull ghcr.io/project-monai/monai-deploy-informatics-gateway:0.2.0
</code></pre>
<h2 id="configure-informatics-gateway">Configure Informatics Gateway</h2>
<p>Use the following commands to initialize the Informatics Gateway and default configuration:</p>
<pre><code class="lang-bash">mig-cli config init
mig-cli config endpoint http://localhost:5000 #skip if running locally
</code></pre>
<pre><code class="lang-powershell">mig-cli.exe config init
mig-cli.exe config endpoint http://localhost:5000 #skip if running locally
</code></pre>
<p>The first command extracts the default <code>appsettings.json</code> file into the home directory:</p>
<ul>
<li>Linux: <code>~/.mig/appsettings.json</code></li>
<li>Windows: <code>C:\Users\[username]\.mig\appsettings.json</code></li>
</ul>
<p>This file is mapped into the Docker container and used by the Informatics Gateway when <code>mig-cli</code> is used to launch the application.</p>
<p>For a complete reference of the <code>appsettings.json</code> file, refer to the <a href="schema.html">Configuration Schema</a>.</p>
<p>The second command passes the endpoint for the Informatics Gateway RESTful API to <code>mig-cli</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>To see available commands, simply execute <code>mig-cli</code> or <code>mig-cli.exe</code>.
Refer to <a href="cli.html">CLI</a> for complete reference.</p>
</div>
<h2 id="database-configuration">Database Configuration</h2>
<p>The Informatics Gateway supports the following database systems:</p>
<ul>
<li>SQLite (default)</li>
<li>MongoDB</li>
</ul>
<h3 id="sqlite-default">SQLite (default)</h3>
<p>SQLite is a lite weight, full-featured SQL database engine and is the default database engine used by the Informatics Gateway.
With SQLite, the Informatics Gateway works out of the box without any external database service dependencies or configuration.</p>
<p>The default configuration maps the database file <code>mig.db</code> in the <code>/database</code> directory.</p>
<pre><code class="lang-json">{
  &quot;ConnectionStrings&quot;: {
    &quot;Type&quot;: &quot;sqlite&quot;,
    &quot;InformaticsGatewayDatabase&quot;: &quot;Data Source=/database/mig.db&quot;
  }
}
</code></pre>
<h3 id="mongodb">MongoDB</h3>
<p>For enterprise installations, <a href="https://www.mongodb.com/">MongoDB</a> is the recommended database solution. To switch from SQLite
to MongoDB, edit the <code>appsettings.json</code> file, and change the <code>ConnectionStrings</code> section to the following with the correct
username, password, IP address/hostname, and port.</p>
<pre><code class="lang-json">{
  &quot;ConnectionStrings&quot;: {
    &quot;Type&quot;: &quot;mongodb&quot;,
    &quot;InformaticsGatewayDatabase&quot;: &quot;mongodb://username:password@IP:port&quot;,
    &quot;DatabaseName&quot;: &quot;InformaticsGateway&quot;
  }
}
</code></pre>
<h2 id="other-database-systems">Other Database Systems</h2>
<p>Extending the Informatics Gateway to support other database systems can be done with a few steps.</p>
<p>If the database system is supported by <a href="https://learn.microsoft.com/en-us/ef/core/providers/">Microsoft Entity Framework</a>, then it can be added to the existing <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway/tree/develop/src/Database/EntityFramework">project</a>.</p>
<p>For other database systems that are not listed in the link above, simply implement the <a class="xref" href="../api/dotnet/Monai.Deploy.InformaticsGateway.Database.Api.Repositories.html">Repository APIs</a>, update the <a class="xref" href="../api/dotnet/Monai.Deploy.InformaticsGateway.Database.DatabaseManager.html">Database Manager</a> to support the new database type and optionally, implement the <a class="xref" href="../api/dotnet/Monai.Deploy.InformaticsGateway.Database.Api.IDatabaseMigrationManager.html">IDabaseMigrationManager</a>.</p>
<h2 id="storage-consideration--configuration">Storage Consideration &amp; Configuration</h2>
<p>The Informatics Gateway operates on two storage locations. In the first location, the incoming data for data grouping is temporarily stored. In the second location, the Informatics Gateway uploads grouped datasets to final storage shared by other MONAI Deploy sub-systems.</p>
<h3 id="temporary-storage-of-incoming-dataset">Temporary Storage of Incoming Dataset</h3>
<p>By default, the temporary storage location is set to use <code>Disk</code> and stores any incoming files inside <code>/payloads</code>.  This can be modified to user a different location, such as <code>Memory</code> or a different path.</p>
<p>To change the temporary storage path, locate the <code>InformaticsGateway&gt;storage&gt;localTemporaryStoragePath</code> property in the <code>appsettings.json</code> file and modify it.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You will need to calculate the required temporary storage based on the number of studies and the size of each study.
Also, consider changing the AE Title timeout if the AE Title needs to wait a long time before assembling and uploading
the payload for final storage.</p>
</div>
<div class="NOTE">
<h5>Note</h5>
<p>Before running the Informatics Gateway, adjust the values of <code>watermarkPercent</code> and <code>reserveSpaceGB</code> based on
the expected number of studies and size of each study. The suggested value for <code>reserveSpaceGB</code> is 2x to 3x the
size of a single study multiplied by the number of configured AE Titles.</p>
</div>
<h3 id="storage-service">Storage Service</h3>
<p>Informatics Gateway includes MinIO as the default storage service provider. To integrate with another storage service provider, please refer to the <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway/blob/main/guidelines/srs.md#data-storage">Data Storage</a> section of the SRS.</p>
<p>Download and install MinIO by following the <a href="https://docs.min.io/docs/minio-quickstart-guide.html">quickstart guide</a>. Once MinIO is installed and configured, modify the storage configuration to enable communication between the Informatics Gateway and MinIO.</p>
<p>Locate the storage section of the configuration in <code>appsettings.json</code>:</p>
<pre><code class="lang-json">{
  &quot;ConnectionStrings&quot;: {
    &quot;InformaticsGatewayDatabase&quot;: &quot;Data Source=migdev.db&quot;
  },
  &quot;InformaticsGateway&quot;: {
    &quot;dicom&quot;: { ... },
    &quot;storage&quot;: {
      &quot;localTemporaryStoragePath&quot;: &quot;/payloads&quot;, # path to store incoming data before uploading to the storage service
      &quot;remoteTemporaryStoragePath&quot;: &quot;/incoming&quot;, # the path on the &quot;temporaryBucketName&quot; where the data is uploaded to before payload assembly
      &quot;bucketName&quot;: &quot;monaideploy&quot;, # name of the bucket for storing payloads
      &quot;temporaryBucketName&quot;: &quot;monaideploy&quot;, # name of the bucket for temporarily storing incoming data before payload is assembled
      &quot;serviceAssemblyName&quot;: &quot;Monai.Deploy.Storage.MinIO.MinIoStorageService, Monai.Deploy.Storage.MinIO&quot;, # the fully qualified assembly name for the storage service to use
      &quot;watermarkPercent&quot;: 75, # a percentage value that indicates when the system shall stop receiving or downloading data.  Disk space is calculated based on the path defined in &quot;localTemporaryStoragePath&quot;
      &quot;reserveSpaceGB&quot;: 5, # minimum disk space required and reserved for the Informatics Gateway
      &quot;settings&quot;: { # settings for the storage library: default to minio
        &quot;endpoint&quot;: &quot;localhost:9000&quot;, # MinIO server IP and port number
        &quot;accessKey&quot;: &quot;admin&quot;, # username/access key
        &quot;accessToken&quot;: &quot;password&quot;, # password/access token
        &quot;securedConnection&quot;: false, # enable secured connection to minio?
        &quot;region&quot;: &quot;local&quot;, # storatge region
        &quot;createBuckets&quot;: &quot;monaideploy&quot; # buckets to be created on startup if not already exists
      }
    },
    ...
  }
}
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Update the <code>createBuckets</code> configuration if you would like to have the Informatics Gateway create the storage buckets on startup.  Otherwise, leave it blank.
To create multiple buckets, separate each bucket name with comma.</p>
</div>
<h4 id="install-the-storage-plug-in">Install the Storage Plug-in</h4>
<p>As shown above, the default plug-in configured is <strong>MinIO</strong> and is ready to use.</p>
<p>To use other storage plug-in, refer to <a href="https://github.com/Project-MONAI/monai-deploy-storage/releases">MONAI Deploy Storage</a> for available plug-ins or bring your own plug-in.</p>
<p>To install a new storage plug-in, unzip the files to the <code>plug-ins</code> directory in your home directory:</p>
<ul>
<li>Linux: <code>~/.mig/plug-ins</code></li>
<li>Windows: <code>C:\Users\[username]\.mig\plug-ins</code></li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p>If a plug-in other than MinIO is used, update the <code>storageService</code> parameter in the <code>appsettings.json</code> file.</p>
</div>
<h3 id="message-broker">Message broker</h3>
<p>The Informatics Gateway communicates with other MONAI Deploy components through a message broker. The default messaging service
included is provided by <a href="https://www.rabbitmq.com/">RabbitMQ</a>. To integrate with another storage service provider, refer
to the <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway/blob/main/guidelines/srs.md#message-broker">Data Storage</a> section of the SRS.</p>
<p>To use the default messaging service, download and install RabbitMQ by following the
<a href="https://www.rabbitmq.com/#getstarted">Get Started</a> page.</p>
<p>The Informatics Gateway publishes all messages to an <em>exchange</em> under the specified <em>virtual host</em>.
Before launching Informatics Gateway, update the <code>appsettings.json</code> file to configure the publisher
and subscriber settings.</p>
<pre><code class="lang-json">{
  &quot;InformaticsGateway&quot;: {
    &quot;messaging&quot;: {
      &quot;publisherServiceAssemblyName&quot;:&quot;Monai.Deploy.Messaging.RabbitMQ.RabbitMQMessagePublisherService, Monai.Deploy.Messaging.RabbitMQ&quot;,
      &quot;publisherSettings&quot;: {
        &quot;endpoint&quot;: &quot;localhost&quot;,
        &quot;username&quot;: &quot;username&quot;,
        &quot;password&quot;: &quot;password&quot;,
        &quot;virtualHost&quot;: &quot;monaideploy&quot;,
        &quot;exchange&quot;: &quot;monaideploy&quot;
      },
      &quot;subscriberServiceAssemblyName&quot;:&quot;Monai.Deploy.Messaging.RabbitMQ.RabbitMQMessageSubscriberService, Monai.Deploy.Messaging.RabbitMQ&quot;,
      &quot;subscriberSettings&quot;: {
        &quot;endpoint&quot;: &quot;localhost&quot;,
        &quot;username&quot;: &quot;username&quot;,
        &quot;password&quot;: &quot;password&quot;,
        &quot;virtualHost&quot;: &quot;monaideploy&quot;,
        &quot;exchange&quot;: &quot;monaideploy&quot;,
        &quot;exportRequestQueue&quot;: &quot;export_tasks&quot;
      }
    },
  }
}
</code></pre>
<h4 id="install-the-messaging-plug-in">Install the Messaging Plug-in</h4>
<p>As shown above, the default plug-in configured is <strong>RabbitMQ</strong> and is ready to use.</p>
<p>To use other plug-in, refer to <a href="https://github.com/Project-MONAI/monai-deploy-messaging/releases">MONAI Deploy Messaging</a> for available plug-ins.</p>
<p>To install a new messaging plug-in, unzip the files to the <code>plug-ins</code> directory in your home directory:</p>
<ul>
<li>Linux: <code>~/.mig/plug-ins</code></li>
<li>Windows: <code>C:\Users\[username]\.mig\plug-ins</code></li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p>If a plug-in other than Rabbit is used, update the <code>publisherServiceAssemblyName</code> and <code>subscriberServiceAssemblyName</code> parameters in the <code>appsettings.json</code> file.</p>
</div>
<h2 id="startstop-informatics-gateway">Start/Stop Informatics Gateway</h2>
<p>To start or stop the Informatics Gateway, update the value of the <code>DockerImagePrefix</code> parameter in
the <code>appsettings.json</code> file with the repository name of the Docker image (the default value is
shown below):</p>
<pre><code class="lang-json">{
    ...,
    &quot;Cli&quot;: {
        &quot;DockerImagePrefix&quot;: &quot;ghcr.io/project-monai/monai-deploy-informatics-gateway&quot;
    }
}
</code></pre>
<p>Lastly, use one of the following commands to start or stop the Informatics Gateway:</p>
<pre><code class="lang-bash">mig-cli start
mig-cli stop
</code></pre>
<h2 id="enable-incoming-associations">Enable Incoming Associations</h2>
<p>The next step is to configure the Informatics Gateway to enable receiving of DICOM instances from external DICOM devices.</p>
<ol>
<li>Configure a listening AE Title to receive instances:</li>
</ol>
<pre><code class="lang-bash">mig-cli aet add -a BrainAET -grouping 0020,000E, -t 30
</code></pre>
<p>The command creates a new listening AE Title with AE Title <code>BrainAET</code>. The listening AE Title
will group instances by the Series Instance UID (0020,000E) with a timeout value of 30 seconds.</p>
<div class="NOTE">
<h5>Note</h5>
<p><code>-grouping</code> is optional, with a default value of 0020,000D.
<code>-t</code> is optional, with a default value of 5 seconds.
For complete reference, refer to the <a href="../api/rest/config.html">Config API</a>.</p>
</div>
<ol start="2">
<li>Enable the receiving of DICOM instances from external DICOM devices:</li>
</ol>
<pre><code class="lang-bash">mig-cli src add -n PACS-LA -a PACSLA001 --h 20.10.30.55
</code></pre>
<p>The above command tells the Informatics Gateway to accept instances from AE Title <code>PACSLA001</code> at IP <code>20.10.30.55</code> and port <code>104</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>By default, Informatics Gateway blocks all unknown sources.
To allow all unknown sources, set the <code>dicom&gt;scp&gt;rejectUnknownSources</code> parameter to <code>false</code> in the <code>appsettings.json</code> file.</p>
</div>
<div class="WARNING">
<h5>Warning</h5>
<p>The Informatics Gateway validates both the source IP address and AE Title when <code>rejectUnknownSources</code> is set to <code>true</code>.
When the Informatics Gateway is running in a container and data is coming from the localhost, the IP address may not be the same as the host IP address. In this case, open the log file and locate the association that failed; the log should indicate the correct IP address under <code>Remote host</code>.</p>
</div>
<h2 id="export-processed-results">Export Processed Results</h2>
<p>If exporting via DIMSE is required, add a DICOM destination:</p>
<pre><code class="lang-bash">mig-cli dst add -a WORKSTATION1 -h 100.200.10.20 -p 104
</code></pre>
<p>The command adds a DICOM export destination with AE Title <code>WORKSTATION1</code> at IP <code>100.200.10.20</code> and port <code>104</code>.</p>
<h2 id="logging">Logging</h2>
<p>See <a href="schema.html#logging">schema</a> page for additional information on logging.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Project-MONAI/monai-deploy-informatics-gateway/blob/main/docs//#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright © 2022 <a href="https://monai.io/">Project MONAI</a><br>Generated by <strong>DocFX</strong>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
